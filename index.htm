<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>æ°‘çœ¾é–±è®€å…¥å£</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background-color: #f1f1f1; }
    button { margin: 10px; padding: 10px 20px; font-size: 16px; }
    .lang-btn { margin-right: 10px; }

    #html-container {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      flex-direction: column;
    }
    #html-frame {
      width: 80%; height: 80%;
      border: none;
      background-color: white;
    }
    #close-btn {
      position: absolute;
      top: 20px; right: 20px;
      background-color: red;
      color: white;
      border: none;
      padding: 10px;
      font-size: 18px;
      cursor: pointer;
      z-index: 1100;
    }
    #toolbar {
      position: absolute;
      top: 20px; left: 20px;
      z-index: 1100;
      background-color: white;
      padding: 10px;
      border-radius: 5px;
    }
    #toolbar button {
      margin-right: 5px;
      padding: 5px 10px;
    }
    #feedback-form {
      display: none;
      background-color: white;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      max-width: 400px;
      margin-top: 30px;
    }
    #feedback-form input[type="radio"] { margin-right: 10px; }
    #feedback-form button { margin-top: 10px; }
  </style>
  <script>
    function openHTML(file) {
      const frame = document.getElementById('html-frame');
      frame.src = file;
      document.getElementById('html-container').style.display = 'flex';
    }

    function closeHTML() {
      document.getElementById('html-container').style.display = 'none';
      document.getElementById('html-frame').src = "";
      showFeedbackForm();
    }

    function showFeedbackForm() {
      document.getElementById('feedback-form').style.display = 'block';
    }

    function submitFeedback() {
      const q1 = document.querySelector('input[name="q1"]:checked').value;
      const q2 = document.querySelector('input[name="q2"]:checked').value;
      const fileName = document.getElementById('html-frame').src.split('?')[0].split('/').pop();

      fetch('https://script.google.com/macros/s/AKfycbxnrDxhiNDIMzODh8AgAB4UHOeuN5kO2rvw9fi1FbgtUEzchLt9CqDH7eeQ1j5Y7dg/exec', {
        method: 'POST',
        body: new URLSearchParams({ fileName, q1, q2 })
      }).then(res => res.json())
        .then(() => alert("æ„Ÿè¬æ‚¨çš„å›é¥‹ï¼"))
        .catch(err => console.error("Error:", err));
    }

function translateIframe(lang = 'en') {
  const iframe = document.getElementById('html-frame');
  const originalUrl = iframe.src;
  const translatedUrl = `https://translate.google.com/translate?sl=auto&tl=${lang}&u=${encodeURIComponent(originalUrl)}`;
  iframe.src = translatedUrl;
}

    function adjustFontSize(delta) {
      const iframe = document.getElementById('html-frame');
      const message = delta > 0 ? "zoomIn" : "zoomOut";
      iframe.contentWindow.postMessage(message, "*");
    }

    function readIframeContent() {
      const iframe = document.getElementById('html-frame');
      try {
        const doc = iframe.contentDocument || iframe.contentWindow.document;
        const text = doc.body.innerText;
        const utterance = new SpeechSynthesisUtterance(text);
        speechSynthesis.speak(utterance);
      } catch (e) {
        alert("ç„¡æ³•æœ—è®€å…§å®¹ï¼Œè«‹ç¢ºèªæ–‡ä»¶ä¾†æºèˆ‡æ ¼å¼");
      }
    }

    function printIframe() {
      const iframe = document.getElementById('html-frame');
      iframe.contentWindow.focus();
      iframe.contentWindow.print();
    }
  </script>
</head>
<body>
  <h1>æ°‘çœ¾é–±è®€å…¥å£</h1>

  <!-- æ–‡ä»¶é¸å–® -->
  <div>
    <button onclick="openHTML('è­·ç†-è¡›æ•™-1-001.html')">å¿ƒè‡Ÿæ‰‹è¡“å¾Œè‡ªæˆ‘ç…§é¡§é ˆçŸ¥</button>
    <button onclick="openHTML('è­·ç†-è¡›æ•™-1-003.html')">å¿ƒè‡Ÿæ‰‹è¡“å¾Œå‚·å£ç…§è­·é ˆçŸ¥</button>
    <button onclick="openHTML('è­·ç†-è¡›æ•™-1-005.html')">èªè­˜ä¸»å‹•è„ˆç˜¤</button>
    <button onclick="openHTML('è­·ç†-è¡›æ•™-1-006.html')">å¿ƒå°ç®¡æª¢æŸ¥é ˆçŸ¥</button>
    <button onclick="openHTML('è­·ç†-è¡›æ•™-2-013.html')">å’€åš¼ååš¥éšœç¤™çš„ä¸­é†«ç©´ä½æŒ‰æ‘©</button>
  </div>

  <!-- HTMLæµ®å‹•è¦–çª— -->
  <div id="html-container">
    <div id="toolbar">
      <button onclick="translateIframe()">ğŸŒ ç¿»è­¯</button>
      <button onclick="adjustFontSize(1)">ğŸ”  æ”¾å¤§</button>
      <button onclick="adjustFontSize(-1)">ğŸ”¡ ç¸®å°</button>
      <button onclick="readIframeContent()">ğŸ”Š æœ—è®€</button>
      <button onclick="printIframe()">ğŸ–¨ï¸ åˆ—å°</button>
    </div>
    <iframe id="html-frame" src="" frameborder="0"></iframe>
    <button id="close-btn" onclick="closeHTML()">X</button>
  </div>

  <!-- æ»¿æ„åº¦èª¿æŸ¥è¡¨å–® -->
  <div id="feedback-form">
    <h3>æ»¿æ„åº¦èª¿æŸ¥</h3>
    <p>1. é€™ä»½è¡›æ•™è³‡æ–™å°æˆ‘ä¾†èªªæ˜¯å®¹æ˜“é–±è®€çš„ï¼Ÿ</p>
    <label><input type="radio" name="q1" value="5" checked> 5</label>
    <label><input type="radio" name="q1" value="4"> 4</label>
    <label><input type="radio" name="q1" value="3"> 3</label>
    <label><input type="radio" name="q1" value="2"> 2</label>
    <label><input type="radio" name="q1" value="1"> 1</label>
    <br><br>
    <p>2. é€™ä»½è¡›æ•™è³‡æ–™å°æˆ‘ä¾†èªªæ˜¯æœ‰å¹«åŠ©çš„ï¼Ÿ</p>
    <label><input type="radio" name="q2" value="5" checked> 5</label>
    <label><input type="radio" name="q2" value="4"> 4</label>
    <label><input type="radio" name="q2" value="3"> 3</label>
    <label><input type="radio" name="q2" value="2"> 2</label>
    <label><input type="radio" name="q2" value="1"> 1</label>
    <br><br>
    <button onclick="submitFeedback()">æäº¤</button>
  </div>
</body>

</html>
